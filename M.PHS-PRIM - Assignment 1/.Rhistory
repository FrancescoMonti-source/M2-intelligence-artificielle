library(stringr)
library(prettyR)
library(ggplot2)
library(tidyverse)
library(ggthemes)
library(colorRamps)
library(corrplot)
library(psych)
library(Hmisc)
data <- read.csv("BDD_VICAN.csv", sep = ";", dec = ",", encoding = "UTF-8")
names(data) = tolower(names(data)) # removing capital letters as working with them can be annoying
data <- read.csv("BDD_VICAN.csv", sep = ";", dec = ",", encoding = "UTF-8")
names(data) = tolower(names(data)) # removing capital letters as working with them can be annoying
head(data) # first lines
data[c(1, 4, 18, 103), ] # lines 1,4,18,103
library(stringr)
library(prettyR)
library(ggplot2)
library(tidyverse)
library(ggthemes)
library(colorRamps)
library(corrplot)
library(psych)
library(Hmisc)
data <- read.csv("BDD_VICAN.csv", sep = ";", dec = ",", encoding = "UTF-8")
names(data) = tolower(names(data)) # removing capital letters as working with them can be annoying
head(data) # first lines
data[c(1, 4, 18, 103), ] # lines 1,4,18,103
sapply(data, function(x) sum(is.na(x))) # NAs by variable
sum(is.na(data)) # global NAs
str(data)
# replacing "," with "." is necessary for as.numeric() to work correctly
data$q5_eortc_fatigue_r1 =
as.numeric(str_replace(data$q5_eortc_fatigue_r1, ",", "."))
sum(is.na(data$q5_eortc_fatigue_r1))  # 6 NAs introduced where cells were "!NULL"
# ----------------------------------- #
# For several variables it could be appropriate to convert them to factors but, at this stage of the analysis its rather optional.
# Health insurance
data$fc_caisse = factor(data$fc_caisse, labels = c("CNAMTS", "MSA", "RSI"))
# Pathology location
data$ms_codcancer = factor(data$ms_codcancer,
labels = c("Breast", "Lung", "Colon & Rectum",
"Prostate", "VADS", "Bladder", "Kidney",
"Thyroid", "Lymphoma", "Melanoma", "Cervix",
"Uterus"))
# Marital status
data$q5_sd4_r1 = factor(data$q5_sd4_r1,
labels = c("Married/Partnered/Concubine",
"Single/Divorced/Separated/Widowed"))
# Children yes/non
data$q5_sd5 = factor(data$q5_sd5, labels = c("Yes", "Non"))
# Level of study
data$q5_sd10_r2 <- factor(data$q5_sd10_r2,
labels = c("No degree", "Less than Bachelor's degree",
"High school diploma or more"))
# Pain
data$q5_pain <- factor(data$q5_pain, labels = c("Yes", "Non"))
# Anxiety
data$q5_anxiete <- factor(data$q5_anxiete,
labels = c("No anxiety", "Questionable anxiety state",
"Certain anxiety state"))
# Net salary category
data$q5_jobv5.36_r1 <- factor(data$q5_jobv5.36_r1,
labels = c("<1500€", ">=1500€","Not employed"))
# Sequels
data$q5_med23.1 <- factor(data$q5_med23.1,
labels = c("YES and they are very important",
"YES and they are important",
"YES but moderate", "YES but very moderate",
"NO, i have no after-effects"))
styler:::style_active_file()
# Associationg a label with each variable, purely for QoL
label(data$fc_caisse) <- "Health insurance"
label(data$ms_codcancer) <- "Pathology's location"
label(data$fc_agediag_r0) <- "Age"
label(data$q5_sd4_r1) <- "Marital status"
label(data$q5_sd5) <- "Children yes/non"
label(data$q5_sd10_r2) <- "Level of study"
label(data$q5_pcs12_r1) <- "Physical QoL"
label(data$q5_mcs12_r1) <- "Mental QoL"
label(data$q5_pain) <- "Pain"
label(data$q5_anxiete) <- "Anxiety"
label(data$q5_depression) <- "Depression"
label(data$q5_jobv5.36_r1) <- "Net salary"
label(data$ms_csp_enq_3c_r1) <- "Socio-professional category"
label(data$q5_med23.1) <- "Sequels"
label(data$q5_eortc_fatigue_r1) <- "EORTC fatigue scale"
data$q5_eortc_fatigue_r1_fac =
cut(data$q5_eortc_fatigue_r1,
breaks = c(0,40,100),
labels = c("Clinically significant", "Not clinically significant"),
include.lowest = T)
label(data$q5_eortc_fatigue_r1_fac) <- "EORTC fatigue scale"
data$q5_med23.1_rec = factor(data$q5_med23.1,
labels = c("Important sequelae","Important sequelae",
"Moderate sequelae", "Moderate sequelae",
"No sequelae"))
a = table(data$q5_med23.1_rec)
b = paste(round(prop.table(table(data$q5_med23.1_rec))*100,2),"%")
print(rbind(a,b))
whole_pop = data$fc_agediag_r0
breast_pop = data$fc_agediag_r0[which(data$ms_codcancer==1)] # 1 = "Breast"
mean(whole_pop) # Mean age of our population
mean(breast_pop) # mean age for breast cancer subpopulation.
mean(breast_pop) # mean age for breast cancer subpopulation.
mean(whole_pop) # Mean age of our population
mean(breast_pop, na.rm=T) # mean age for breast cancer subpopulation.
breast_pop
breast_pop = data$fc_agediag_r0[which(data$ms_codcancer=="Breast")]
mean(breast_pop, na.rm=T) # mean age for breast cancer subpopulation.
t.test(whole_pop)$"conf.int" # T confidence intervals for the whole population
t.test(breast_pop)$"conf.int" # T confidence interval for the breast cancer subpopulation
describe(whole_pop,num.desc=c("var","sd"), xname="the age variable for the whole population", horizontal=FALSE)
describe(breast_pop,num.desc=c("var","sd"), xname="the age variable for the breast cancer population", horizontal=FALSE)
prettyR::describe(whole_pop,num.desc=c("var","sd"), xname="the age variable for the whole population", horizontal=FALSE)
prettyR::describe(breast_pop,num.desc=c("var","sd"), xname="the age variable for the breast cancer population", horizontal=FALSE)
# Solution 1
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, fill = ms_codcancer)) +
geom_density()+
scale_fill_brewer(palette="Set3")+
scale_y_continuous(breaks = seq(0,0.1, 0.01), minor_breaks = seq(0, 0.005, 0.01))+
scale_x_continuous(breaks = seq(0,100, 5))+
labs(x = "Age",
y = "Distribution probability",
title = "Age distribution by cancer location",
fill = "Cancer location")+
facet_grid(vars(ms_codcancer))+
theme(strip.text.y = element_text(size = 7))
# Solution 2
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, fill = ms_codcancer)) +
geom_density()+
scale_fill_brewer(palette="Set3")+
scale_y_continuous(breaks = seq(0,0.1, 0.01), minor_breaks = seq(0, 0.005, 0.01))+
scale_x_continuous(breaks = seq(0,100, 5))+
labs(x = "Age",
y = "Distribution probability",
title = "Age distribution by cancer location",
fill = "Cancer location")+
facet_wrap(vars(ms_codcancer))
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", linewidth = 1.2, alpha = .4)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", linewidth = 1.2)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", linewidth = 2)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", width = 2)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", size = 2)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", size = 1.2)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
# Solution 3
ggplot(data = data,
aes(x=fc_agediag_r0, group = ms_codcancer, colour = ms_codcancer)) +
geom_density(stat = "bin", size = 1)+
scale_color_manual(values = primary.colors(n=12, step = 6))+
scale_x_continuous(breaks = seq(0,100, 5))+
scale_y_continuous(breaks = seq(0,1000, 10))+
labs(x = "Age",
y = "Count",
title = "Age distribution by cancer location",
colour = "Cancer location")+ theme_excel()
str(data)
names(data)
labels(data)
View(data)
attributes(data)
label(data)
label(data)
label(data) %>% kable
install.package("kable")
install.packages("kable")
install.packages("knitr")
install.packages("knitr")
library(knitr)
label(data) %>% kable
kable(label(data))
library(psych)
kable(label(data))
library(Hmisc)
kable(label(data))
label(data)
# Chunk 1: libraries
library(stringr)
library(prettyR)
library(ggplot2)
library(tidyverse)
library(ggthemes)
library(colorRamps)
library(corrplot)
library(psych)
library(Hmisc)
# Chunk 2
data <- read.csv("BDD_VICAN.csv", sep = ";", dec = ",", encoding = "UTF-8")
names(data) = tolower(names(data)) # removing capital letters as working with them can be annoying
# Chunk 3
head(data) # first lines
data[c(1, 4, 18, 103), ] # lines 1,4,18,103
# Chunk 4
ncol(data) # variables count
nrow(data) # observations count
# Chunk 5
sapply(data, function(x) sum(is.na(x))) # NAs by variable
sum(is.na(data)) # global NAs
# Chunk 6
str(data)
# Chunk 7
# replacing "," with "." is necessary for as.numeric() to work correctly
data$q5_eortc_fatigue_r1 =
as.numeric(str_replace(data$q5_eortc_fatigue_r1, ",", "."))
sum(is.na(data$q5_eortc_fatigue_r1))  # 6 NAs introduced where cells were "!NULL"
# ----------------------------------- #
# For several variables it could be appropriate to convert them to factors but, at this stage of the analysis its rather optional.
# Health insurance
data$fc_caisse = factor(data$fc_caisse, labels = c("CNAMTS", "MSA", "RSI"))
# Pathology location
data$ms_codcancer = factor(data$ms_codcancer,
labels = c("Breast", "Lung", "Colon & Rectum",
"Prostate", "VADS", "Bladder", "Kidney",
"Thyroid", "Lymphoma", "Melanoma", "Cervix",
"Uterus"))
# Marital status
data$q5_sd4_r1 = factor(data$q5_sd4_r1,
labels = c("Married/Partnered/Concubine",
"Single/Divorced/Separated/Widowed"))
# Children yes/non
data$q5_sd5 = factor(data$q5_sd5, labels = c("Yes", "Non"))
# Level of study
data$q5_sd10_r2 <- factor(data$q5_sd10_r2,
labels = c("No degree", "Less than Bachelor's degree",
"High school diploma or more"))
# Pain
data$q5_pain <- factor(data$q5_pain, labels = c("Yes", "Non"))
# Anxiety
data$q5_anxiete <- factor(data$q5_anxiete,
labels = c("No anxiety", "Questionable anxiety state",
"Certain anxiety state"))
# Net salary category
data$q5_jobv5.36_r1 <- factor(data$q5_jobv5.36_r1,
labels = c("<1500€", ">=1500€","Not employed"))
# Sequels
data$q5_med23.1 <- factor(data$q5_med23.1,
labels = c("YES and they are very important",
"YES and they are important",
"YES but moderate", "YES but very moderate",
"NO, i have no after-effects"))
# Chunk 8
# Associationg a label with each variable, purely for QoL
label(data$fc_caisse) <- "Health insurance"
label(data$ms_codcancer) <- "Pathology's location"
label(data$fc_agediag_r0) <- "Age"
label(data$q5_sd4_r1) <- "Marital status"
label(data$q5_sd5) <- "Children yes/non"
label(data$q5_sd10_r2) <- "Level of study"
label(data$q5_pcs12_r1) <- "Physical QoL"
label(data$q5_mcs12_r1) <- "Mental QoL"
label(data$q5_pain) <- "Pain"
label(data$q5_anxiete) <- "Anxiety"
label(data$q5_depression) <- "Depression"
label(data$q5_jobv5.36_r1) <- "Net salary"
label(data$ms_csp_enq_3c_r1) <- "Socio-professional category"
label(data$q5_med23.1) <- "Sequels"
label(data$q5_eortc_fatigue_r1) <- "EORTC fatigue scale"
# Chunk 9
data$q5_eortc_fatigue_r1_fac =
cut(data$q5_eortc_fatigue_r1,
breaks = c(0,40,100),
labels = c("Clinically significant", "Not clinically significant"),
include.lowest = T)
label(data$q5_eortc_fatigue_r1_fac) <- "EORTC fatigue scale"
# Chunk 10
data$q5_med23.1_rec = factor(data$q5_med23.1,
labels = c("Important sequelae","Important sequelae",
"Moderate sequelae", "Moderate sequelae",
"No sequelae"))
# Chunk 11
a = table(data$q5_med23.1_rec)
b = paste(round(prop.table(table(data$q5_med23.1_rec))*100,2),"%")
print(rbind(a,b))
# Chunk 12
whole_pop = data$fc_agediag_r0
breast_pop = data$fc_agediag_r0[which(data$ms_codcancer=="Breast")]
mean(whole_pop) # Mean age of our population
mean(breast_pop, na.rm=T) # mean age for breast cancer subpopulation.
# Chunk 13
t.test(whole_pop)$"conf.int" # T confidence intervals for the whole population
t.test(breast_pop)$"conf.int" # T confidence interval for the breast cancer subpopulation
# Chunk 14
prettyR::describe(whole_pop,num.desc=c("var","sd"), xname="the age variable for the whole population", horizontal=FALSE)
prettyR::describe(breast_pop,num.desc=c("var","sd"), xname="the age variable for the breast cancer population", horizontal=FALSE)
kable(label(data))
label(data)[1]
label(data)[,1]
label(data) %>% class
label(data) %>% as.data.frame()
label(data) %>% as.data.frame() %>% select(1)
label(data) %>% as.data.frame() %>% row.names()
label(data) %>% row.names()
kable(label(data))
explicative_variables = c("fc_caisse", "ms_codcancer","fc_agediag_r0","q5_sd4_r1","q5_sd5","q5_s10_r2","q5_eortc_fatigue_r1_fac", "q5_anxiete","q5_depression","q5_jobv5.36_r1","q5_med23.1_rec","q5_pain")
kable(label(explicative_variables))
kable(label(data[explicative_variables])
)
data[explicative_variables]
explicative_variables = c("fc_caisse", "ms_codcancer","fc_agediag_r0","q5_sd4_r1","q5_sd5","q5_sd10_r2","q5_eortc_fatigue_r1_fac", "q5_anxiete","q5_depression","q5_jobv5.36_r1","q5_med23.1_rec","q5_pain")
data[explicative_variables]
kable(label(data[explicative_variables]))
label(data$q5_med23.1_rec) = "Sequels"
kable(label(data[explicative_variables]))
lm(data = data, qol_mental ~ fc_caisse + ms_codcancer)
attach(data)
lm(data = data, qol_mental ~ fc_caisse + ms_codcancer)
detach(data)
kable(label(data))
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer)
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.26_r1 + q5_med23.1_rec + q5_pain)
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain)
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain) %>% summary
# Recoding the reference for qualitative variables
sapply(data,is.factor)
# Recoding the reference for qualitative variables
sapply(data,is.factor)==1
# Recoding the reference for qualitative variables
sapply(data,is.factor)==TRUE
# Recoding the reference for qualitative variables
sapply(data,is.factor)>0
# Recoding the reference for qualitative variables
subset(sapply(data,is.factor), sapply(data,is.factor)>0)
data$fc_caisse %>% unique
sapply(data[sapply(data,is.factor)], unique)
factor(data$ms_csp_enq_3c_r1,
labels = c("Executives", "Managerial occupations", "Not employed"))
# Social category
data$ms_csp_enq_3c_r1 <- factor(data$ms_csp_enq_3c_r1,
labels = c("Executives", "Managerial occupations", "Not employed"))
# Printing the list of explicative variables that are gonna be used in the model
kable(label(data[explicative_variables]))
# Recoding the reference for qualitative variables
# List of factors to be recoded to make sure we correctly interpret the results
subset(sapply(data,is.factor), sapply(data,is.factor)>0)
explicative_variables = c("fc_caisse", "ms_codcancer","fc_agediag_r0","q5_sd4_r1","q5_sd5","q5_sd10_r2","q5_eortc_fatigue_r1_fac", "q5_anxiete","q5_depression","q5_jobv5.36_r1","ms_csp_enq_3c_r1", "q5_med23.1_rec","q5_pain")
# Printing the list of explicative variables that are gonna be used in the model
kable(label(data[explicative_variables]))
label(data$ms_csp_enq_3c_r1) <- "Socio-professional category"
# Printing the list of explicative variables that are gonna be used in the model
kable(label(data[explicative_variables]))
sapply(data[sapply(data,is.factor)], unique)
# Recoding the reference for qualitative variables
# List of factors to be recoded to make sure we correctly interpret the results
subset(sapply(data,is.factor), sapply(data,is.factor)==1)
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain)
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain) %>% summary
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain) %>% summary %>% class
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain) %>% summary %>% select(... = )
# Physical
lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain) %>% summary %>% select(coefficients)
# Physical
mod1 = lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain)
summary(mod1)$coef
summary(mod1)[1]
summary(mod1)[3]
summary(mod1)[4]
summary(mod1)[1,4]
summary(mod1)[4][[1]]
summary(mod1)[4][1]
summary(mod1)[4][,1]
summary(mod1)[4][2]
summary(mod1)[4][3]
summary(mod1)[4][[3]]
summary(mod1)[4][[1]]
summary(mod1)[4][[1]] %>% class
summary(mod1)[4] %>% data.frame()
summary(mod1)[4] %>% data.frame() %>% names
summary(mod1)[4] %>% data.frame() %>% rename("ciao")
names(data.frame(summary(mod1)$coefficients))
data.frame(summary(mod1)$`Pr...t..`
data.frame(summary(mod1))$`Pr...t..`
data.frame(summary(mod1))
data.frame(summary(mod1)$coefficients)
data.frame(summary(mod1)$coefficients)$`Pr...t..`
data.frame(summary(mod1)$coefficients)
data.frame(summary(mod1)$coefficients) %>% filter("Pr...t.." < 0.2)
data.frame(summary(mod1)$coefficients) %>% filter(`Pr...t..` < 0.2)
data.frame(summary(mod1)$coefficients) %>% filter(`Pr...t..` < 0.2) %>% arrange(Estimate)
data.frame(summary(mod1)$coefficients) %>% filter(`Pr...t..` < 0.2) %>% arrange(Estimate)
relevel(data$fc_caisse, ref = "CNAMTS")
relevel(data$ms_codcancer, ref = "Breast")
relevel(data$q5_sd4_r1, ref = "Married/Partnered/Concubine")
relevel(data$q5_sd5, ref = "Non")
relevel(data$q5_sd10_r2, ref = "No degree")
relevel(data$q5_anxiete, ref = "No anxiety")
relevel(data$q5_jobv5.36_r1, ref = "Not employed")
relevel(data$ms_csp_enq_3c_r1, ref = "Not employed")
relevel(data$q5_med23.1_rec, ref = "No sequelae")
relevel(data$q5_pain, ref = "Non")
relevel(data$q5_eortc_fatigue_r1_fac, ref = "Not clinically significant")
# Physical
mod1 <- lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain)
data.frame(summary(mod1)$coefficients) %>% filter(`Pr...t..` < 0.2) %>% arrange(Estimate)
# Physical
mod1 <- lm(data = data, q5_pcs12_r1 ~ fc_caisse + ms_codcancer + fc_agediag_r0 + q5_sd4_r1 + q5_sd5 + q5_sd10_r2 + q5_eortc_fatigue_r1_fac + q5_anxiete + q5_depression + q5_jobv5.36_r1 + q5_med23.1_rec + q5_pain)
data.frame(summary(mod1)$coefficients) %>% filter(`Pr...t..` < 0.2) %>% arrange(Estimate)
relevel(data$q5_eortc_fatigue_r1_fac, ref = "Not clinically significant")
summary(mod1)
